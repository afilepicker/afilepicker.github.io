<script wis-load=third-party-peer src=u/js/peer.js></script><script wis-load=other-device>var newId="";wis.app.register.controller("OtherDeviceCtrl",["file","$scope","$http","$cacheFactory",function(e,t){function n(n){console.log(n);{var a,o,s=!1,i=[],l=0;new Date}n.on("data",function(c){if(c[r.event_name]==r.retrive_meta){var d={name:c[r.name],type:c[r.type],size:c[r.size],lastModifiedDate:c[r.lastModifiedDate],chunks:c[r.chunks],blobs:[],startTime:0,buff:new Uint8Array(c[r.size]),loaded:0};e.files.push(d),i.push(d),s||(o=d,d.startTime=new Date,n.send(r.request_nextChunk),a=setInterval(function(){t.$root.$apply()},1e3)),s=!0,t.$root.$apply()}else o.blobs.push(""),o.buff.set(new Uint8Array(c),o.loaded),o.blobs.length!=o.chunks?(n.send(r.request_nextChunk),o.loaded+=c.byteLength,o.elapsedTime=Date.now()-o.startTime,o.bytesPerSec=Math.ceil(o.loaded/o.elapsedTime*1024),o.percent=Math.ceil(o.loaded/o.size*100),o.chunksPerTime=o.blobs.length/o.elapsedTime,o.estimatedTotalTime=o.chunks/o.chunksPerTime,o.timeLeftInSeconds=(o.estimatedTotalTime-o.elapsedTime)/1e3):(o.loaded+=c.byteLength,i.shift(),l=0,(o=o[0])?(o.startTime=new Date,n.send(r.request_nextChunk)):(s=!1,clearInterval(a),t.$root.$apply()))}),n.on("close",function(){console.log("%s has left",n.peer)})}var a,o=Math.floor(0x40000000000000*Math.random()+1),s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=s.length,i=[],l=-1,c=this;if(!newId){for(;o>0;o=Math.floor(o/r))i.push(o%r>=10?s[o%r-10]:o%r),l+=1;for(a=l;a>=0;a--)newId+=i[a]}c.url=location.origin+"/?owner="+newId,c.qr="https://chart.googleapis.com/chart?chs=250x250&cht=qr&chl="+encodeURIComponent(c.url);var d=new Peer("Owner"+newId,{host:"buddleja.asuscomm.com",port:9e3}),r={event_name:0,request_nextChunk:1,retrive_meta:2,name:3,size:4,chunks:5,type:6,lastModifiedDate:7};d.on("connection",n)}]);</script><div ng-controller="OtherDeviceCtrl as my"><h1>Open this url in another browser</h1><input ng-model=my.url onload=this.select()> <img ng-src={{my.qr}}></div>