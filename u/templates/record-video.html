<script wis-load=my-photo>wis.app.register.controller("PhotoCtrl",["file","$filter","$scope",function(e,t,o){function i(e){if(r=e,"mozSrcObject"in c)c.mozSrcObject=e;else{var t=wis.vendor(window,"URL");c.src=t?t.createObjectURL(e):e}c.play(),a.promoting=!1,o.$apply()}function n(e){console.log("An error occured! "+e)}var a=this,r=!1,d=wis.query("video"),c=d[0],l={video:!0,audio:!1},s=wis.el("canvas"),g=s.getContext("2d");a.promoting=!0,a.add=function(e){console.log(e)},wis.vendor(navigator,"getUserMedia",l,i,n),a.capture=function(){g.drawImage(c,0,0,s.width,s.height);var o="DataUrl",i=s.toDataURL(),n=new Date,a="Bild "+t("date")(n,"yyyy-MM-dd kl. HH.mm.ss")+".png",r=Math.round(3*i.split(",")[1].replace(/=/g,"").length/4),d="image/png",l="";e.add(o,i,n,a,r,d,l)},d.on("canplay",function(){r&&(s.width=c.videoWidth,s.height=c.videoHeight,g.translate(s.width,0),g.scale(-1,1))}),o.$on("$destroy",function(){c.pause(),r&&r.stop()})}]);</script><div ng-controller="PhotoCtrl as Photo"><div ng-if=!Main.supports.captureInput class="alert alert-info"><a href=other-device>Use your Smartphone to take a photo</a> <button type=button class=close wis-dismiss=rec aria-hidden=true>&times;</button></div><div ng-if=Main.supports.captureInput class="alert alert-info"><label for=own>Use your own application to take a sound</label><button type=button class=close aria-hidden=true>&times;</button> <input id=own class=ng-hide type=file ng-model=Photo.files ng-change=Photo.add($event) name=photo accept=image/* capture></div><span ng-hide=Photo.promoting id=takePitcture><video></video><button class=ui-up ng-click=Photo.capture() id=shutter></button></span></div>